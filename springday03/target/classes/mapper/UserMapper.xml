<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="test">
    
    <resultMap id="userList" type="org.hgh.pojo.User">
        <result property="id" column="id"/>
        <result property="username" column="username"/>
        <result property="birthday" column="birthday"/>
        <result property="sex" column="sex"/>
        <result property="address" column="address"/>
    </resultMap>
    
    <select id="findUserById" parameterType = "java.lang.Integer" resultType="org.hgh.pojo.User">
        select * from user where id = #{id}
    </select>

    <!-- $符无法防止sql注入攻击 -->
    <select id="findUserByUsername" parameterType="java.lang.String" resultMap="userList">
        select * from user where username like ${value}
    </select>
    
    <insert id="addUser" parameterType="org.hgh.pojo.User">
        insert into user (username,birthday,sex,address) values (#{username},#{birthday},#{sex},#{address});
    </insert>

    <insert id="addUserGetId" parameterType="org.hgh.pojo.User">
        <selectKey keyProperty="id" resultType="java.lang.Integer" order="AFTER">
            select LAST_INSERT_ID()
        </selectKey>
        insert into user (username,birthday,sex,address) values (#{username},#{birthday},#{sex},#{address});
    </insert>

    <insert id="addUserGetUUID" parameterType="org.hgh.pojo.User">
        <selectKey keyProperty="id" resultType="java.lang.Integer" order="BEFORE">
            select uuid()
        </selectKey>
        insert into user (username,birthday,sex,address) values (#{username},#{birthday},#{sex},#{address});
    </insert>

<!--    <insert id="addUserGetId" parameterType="org.hgh.pojo.User">-->
<!--        <selectKey keyProperty="id" resultType="java.lang.Integer" order="BEFORE">-->
<!--            select UUID()-->
<!--        </selectKey>-->
<!--        insert into user (username,birthday,sex,address) values (#{username},#{birthday},#{sex},#{address});-->
<!--    </insert>-->
</mapper>

